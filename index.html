<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Calculadora Genética Gecko Leopardo — Combos</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background:#fafafa; }
  h1{margin-bottom:8px;}
  label {display:block; margin:10px 0 6px;}
  select {margin-right:8px; padding:6px;}
  button {margin-top:12px; padding:8px 12px;}
  .combo-logrado { background-color: #d4edda; padding:12px; margin:10px 0; border-radius:6px; }
  .empty { color:#666; padding:12px; background:#fff; border-radius:6px; border:1px solid #eee; }
  /* ocultamos todo lo demás por petición del usuario */
  #otras-secciones { display:none; }
</style>
</head>
<body>

<h1>Calculadora Genética – Gecko Leopardo</h1>
<p>Selecciona padre/madre por cada gen. (La vista muestra sólo los <strong>Combos logrados</strong>.)</p>

<!-- Inputs (se mantienen todos, pero sólo mostramos combos después) -->
<div id="inputs">
  <h3>Genes Recesivos</h3>
  <label>Tremper Albino:
    <select id="tremperPadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
    <select id="tremperMadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
  </label>

  <label>Bell Albino:
    <select id="bellPadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
    <select id="bellMadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
  </label>

  <label>Rainwater Albino:
    <select id="rainPadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
    <select id="rainMadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
  </label>

  <label>Eclipse:
    <select id="eclipsePadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
    <select id="eclipseMadre"><option value=""></option><option value="het">Het</option><option value="visual">Visual</option></select>
  </label>

  <h3>Co-dominantes</h3>
  <label>Blizzard:
    <select id="blizzardPadre"><option value=""></option><option value="presente">Presente</option></select>
    <select id="blizzardMadre"><option value=""></option><option value="presente">Presente</option></select>
  </label>

  <label>Murphy Patternless:
    <select id="murphyPadre"><option value=""></option><option value="presente">Presente</option></select>
    <select id="murphyMadre"><option value=""></option><option value="presente">Presente</option></select>
  </label>

  <label>Mack Snow:
    <select id="mackPadre"><option value=""></option><option value="presente">Presente</option></select>
    <select id="mackMadre"><option value=""></option><option value="presente">Presente</option></select>
  </label>

  <label>Super Mack Snow:
    <select id="superMackPadre"><option value=""></option><option value="presente">Presente</option></select>
    <select id="superMackMadre"><option value=""></option><option value="presente">Presente</option></select>
  </label>

  <label>Giant:
    <select id="giantPadre"><option value=""></option><option value="presente">Giant</option></select>
    <select id="giantMadre"><option value=""></option><option value="presente">Giant</option></select>
  </label>

  <label>Super Giant:
    <select id="superGiantPadre"><option value=""></option><option value="presente">Super Giant</option></select>
    <select id="superGiantMadre"><option value=""></option><option value="presente">Super Giant</option></select>
  </label>

  <h3>Dominantes</h3>
  <label>Enigma:
    <select id="enigmaPadre"><option value=""></option><option value="presente">Presente</option></select>
    <select id="enigmaMadre"><option value=""></option><option value="presente">Presente</option></select>
  </label>

  <label>White & Yellow:
    <select id="wyPadre"><option value=""></option><option value="presente">Presente</option></select>
    <select id="wyMadre"><option value=""></option><option value="presente">Presente</option></select>
  </label>

  <div style="margin-top:10px;">
    <button id="btnCalcular">Calcular combos</button>
  </div>
</div>

<!-- SOLO MOSTRAMOS ESTA SECCIÓN -->
<h2>Combos logrados</h2>
<div id="combosContainer">
  <div class="empty">Presiona "Calcular combos" para ver combos con probabilidad &gt; 1%</div>
</div>

<script>
/* --- Helpers: probabilidades de gameto --- */
function probGametoRecesivo(parentState){
  if(parentState === 'visual') return 1.0;
  if(parentState === 'het') return 0.5;
  return 0.0;
}
function probGametoAlelo(parentState){
  if(parentState === 'super') return 1.0;
  if(parentState === 'presente') return 0.5;
  return 0.0;
}

/* --- Lógica de cálculo (basada en tu código) --- */
document.getElementById('btnCalcular').addEventListener('click', calcularCombos);

function leerGenesDeInputs(){
  return {
    tremper: [document.getElementById('tremperPadre').value, document.getElementById('tremperMadre').value],
    bell: [document.getElementById('bellPadre').value, document.getElementById('bellMadre').value],
    rain: [document.getElementById('rainPadre').value, document.getElementById('rainMadre').value],
    eclipse: [document.getElementById('eclipsePadre').value, document.getElementById('eclipseMadre').value],
    blizzard: [document.getElementById('blizzardPadre').value, document.getElementById('blizzardMadre').value],
    murphy: [document.getElementById('murphyPadre').value, document.getElementById('murphyMadre').value],
    mack: [document.getElementById('mackPadre').value, document.getElementById('mackMadre').value],
    superMack: [document.getElementById('superMackPadre').value, document.getElementById('superMackMadre').value],
    giant: [document.getElementById('giantPadre').value, document.getElementById('giantMadre').value],
    superGiant: [document.getElementById('superGiantPadre').value, document.getElementById('superGiantMadre').value],
    enigma: [document.getElementById('enigmaPadre').value, document.getElementById('enigmaMadre').value],
    wy: [document.getElementById('wyPadre').value, document.getElementById('wyMadre').value]
  };
}

function calcularCombos(){
  const genes = leerGenesDeInputs();

  // combos (misma lista que usas)
  const combos = [
    {name:'BEE',genes:['enigma','eclipse'],linea:'tremper'},
    {name:'Black Hole',genes:['mack','enigma','eclipse'],linea:'tremper'},
    {name:'Total Eclipse',genes:['superMack','eclipse'],linea:'tremper'},
    {name:'Universe',genes:['superMack','eclipse','wy'],linea:'tremper'},
    {name:'Banana Blizzard',genes:['murphy','blizzard'],linea:'tremper'},
    {name:'Super Platinum',genes:['superMack','murphy'],linea:'tremper'},
    {name:'Raptor',genes:['tremper','eclipse','murphy'],linea:'tremper'},
    {name:'Aptor',genes:['tremper','murphy'],linea:'tremper'},
    {name:'Ember',genes:['tremper','eclipse','murphy'],linea:'tremper'},
    {name:'Snowflake',genes:['mack','tremper','eclipse','murphy'],linea:'tremper'},
    {name:'Blazing Blizzard',genes:['tremper','blizzard'],linea:'tremper'},
    {name:'Diablo Blanco',genes:['tremper','blizzard','eclipse'],linea:'tremper'},
    {name:'Nova',genes:['tremper','eclipse','enigma'],linea:'tremper'},
    {name:'Super Nova',genes:['superMack','tremper','eclipse','enigma'],linea:'tremper'},
    {name:'Dreamsickle',genes:['mack','tremper','eclipse','enigma'],linea:'tremper'},
    {name:'Radar',genes:['bell','eclipse'],linea:'bell'},
    {name:'Stealth',genes:['mack','enigma','bell','eclipse'],linea:'bell'},
    {name:'Super Stealth',genes:['superMack','radar','enigma'],linea:'bell'},
    {name:'White Knight',genes:['bell','eclipse','blizzard'],linea:'bell'},
    {name:'Typhoon',genes:['rain','eclipse'],linea:'rain'},
    {name:'Cyclone',genes:['rain','eclipse','murphy'],linea:'rain'}
  ];

  // Determinar la línea (si hay más de una línea presente, priorizamos en orden tremper,bell,rain según detecte)
  let linea = '';
  if (genes.tremper.includes('visual') || genes.tremper.includes('het')) linea='tremper';
  else if (genes.bell.includes('visual') || genes.bell.includes('het')) linea='bell';
  else if (genes.rain.includes('visual') || genes.rain.includes('het')) linea='rain';

  const combosLogrados = [];

  combos.forEach(c => {
    if (c.linea !== linea) return; // no mezclar líneas
    // calculamos probabilidad del combo multiplicando probabilidades por gen
    let probCombo = 1;
    let anyNonZero = false;

    c.genes.forEach(g => {
      const vals = genes[g] || ["",""];
      const pFatherState = vals[0] || "";
      const pMotherState = vals[1] || "";
      let pGene = 0;

      // recesivos: necesitamos aa (visual)
      if (['tremper','bell','rain','eclipse'].includes(g)) {
        const pa = probGametoRecesivo(pFatherState);
        const pb = probGametoRecesivo(pMotherState);
        pGene = pa * pb; // prob aa
      }
      // codominantes: super (homo) o "presente" (al menos un alelo)
      else if (['superMack','superGiant'].includes(g)) {
        // para "super" se requiere que ambos gametos lleven el alelo (homozygous)
        const pa = probGametoAlelo(pFatherState);
        const pb = probGametoAlelo(pMotherState);
        pGene = pa * pb;
      }
      else if (['mack','murphy','blizzard','giant'].includes(g)) {
        // prob de "presente" (al menos un alelo en cría)
        const pa = probGametoAlelo(pFatherState);
        const pb = probGametoAlelo(pMotherState);
        pGene = 1 - (1 - pa) * (1 - pb);
      }
      // dominantes / wy / enigma
      else if (['enigma','wy'].includes(g)) {
        const pa = probGametoAlelo(pFatherState);
        const pb = probGametoAlelo(pMotherState);
        pGene = 1 - (1 - pa) * (1 - pb);
      }
      else {
        // fallback: tratar como "presente"
        const pa = probGametoAlelo(pFatherState);
        const pb = probGametoAlelo(pMotherState);
        pGene = 1 - (1 - pa) * (1 - pb);
      }

      if (pGene > 0) anyNonZero = true;
      probCombo *= pGene;
    });

    // solo mostrar combos con prob > 1%
    if (probCombo * 100 > 1) {
      combosLogrados.push({name:c.name, genes:c.genes, prob: probCombo});
    }
  });

  // renderizar sólo combos logrados
  const cont = document.getElementById('combosContainer');
  cont.innerHTML = '';

  if (combosLogrados.length === 0) {
    cont.innerHTML = '<div class="empty">No hay combos con probabilidad > 1% para la configuración actual.</div>';
    return;
  }

  // ordenar por probabilidad descendente (opcional, ayuda a ver lo más probable)
  combosLogrados.sort((a,b) => b.prob - a.prob);

  combosLogrados.forEach(c => {
    const html = `<div class="combo-logrado">✅ ${c.name} (${c.genes.join(' + ')}) ≈ ${(c.prob*100).toFixed(1)}%</div>`;
    cont.insertAdjacentHTML('beforeend', html);
  });
}
</script>
</body>
</html>
