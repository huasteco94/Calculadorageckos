<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Genética Gecko Leopardo</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
h2 { margin-top: 20px; }
section { margin-bottom: 20px; }
label { display: block; margin-top: 10px; }
select { width: 200px; margin-top: 5px; }
.result { border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
.combo { margin-left: 20px; }
</style>
</head>
<body>

<h1>Calculadora Genética Gecko Leopardo</h1>

<section>
  <h2>Selecciona los progenitores</h2>
  <label>Macho
    <select id="padre">
      <option value="">Selecciona macho</option>
    </select>
  </label>
  <label>Hembra
    <select id="madre">
      <option value="">Selecciona hembra</option>
    </select>
  </label>
</section>

<section>
  <h2>Resultados Genéticos</h2>
  <div id="resultados" class="result"></div>
</section>

<section>
  <h2>Combos logrados</h2>
  <div id="combos" class="result"></div>
</section>

<section>
  <h2>Rutas a combos</h2>
  <div id="rutas" class="result"></div>
</section>

<section>
  <h2>Líneas poligénicas</h2>
  <div id="poligenicos" class="result"></div>
</section>

<script>
// ====== Datos de ejemplo ======
const genesRecesivos = ["tremper","bell","rain","eclipse","blizzard","murphy"];
const genesCodominantes = ["mack","superMack","giant"];
const genesDominantes = ["enigma","wy","whiteYellow"];
const poligenicos = ["mandarin","tangerine","blood","bloodInferno","bloodElectric","tornado"];

// Combos definidos
const combos = [
  {name:"BEE", genes:["enigma","eclipse"]},
  {name:"Black Hole", genes:["mack","enigma","eclipse"]},
  {name:"Total Eclipse", genes:["superMack","eclipse"]},
  {name:"Universe", genes:["superMack","eclipse","wy"]},
  {name:"Banana Blizzard", genes:["murphy","blizzard"]},
  {name:"Super Platinum", genes:["superMack","murphy"]},
  {name:"Raptor", genes:["tremper","eclipse","murphy"]},
  {name:"Aptor", genes:["tremper","murphy"]},
  {name:"Ember", genes:["tremper","eclipse","murphy"]},
  {name:"Snowflake", genes:["mack","tremper","eclipse","murphy"]},
  {name:"Blazing Blizzard", genes:["blizzard"]},
  {name:"Diablo Blanco", genes:["tremper","blizzard","eclipse"]},
  {name:"Nova", genes:["tremper","eclipse","enigma"]},
  {name:"Super Nova", genes:["superMack","tremper","eclipse","enigma"]},
  {name:"Dreamsickle", genes:["mack","tremper","eclipse","enigma"]},
  {name:"Radar", genes:["bell","eclipse"]},
  {name:"Stealth", genes:["mack","enigma","bell","eclipse"]},
  {name:"Super Stealth", genes:["superMack","radar","enigma"]},
  {name:"White Knight", genes:["bell","eclipse","blizzard"]},
  {name:"Typhoon", genes:["rain","eclipse"]},
  {name:"Cyclone", genes:["rain","eclipse","murphy"]}
];

// Ejemplo de progenitores
const progenitores = [
  {id:1, nombre:"Gecko1", genes:{tremper:"het",eclipse:"visual",mack:"presente",superMack:"",wy:"",giant:"",blizzard:"",murphy:"",bell:"",rain:"",enigma:"presente",whiteYellow:""}},
  {id:2, nombre:"Gecko2", genes:{tremper:"",eclipse:"het",mack:"presente",superMack:"super",wy:"presente",giant:"giant",blizzard:"het",murphy:"het",bell:"",rain:"",enigma:"",whiteYellow:""}}  
];

// ====== Llenar select padre/madre ======
const padreSelect = document.getElementById("padre");
const madreSelect = document.getElementById("madre");
progenitores.forEach(p => {
  padreSelect.innerHTML += `<option value="${p.id}">${p.nombre}</option>`;
  madreSelect.innerHTML += `<option value="${p.id}">${p.nombre}</option>`;
});

// ====== Funciones de cálculo ======
function calcularPorcentaje(gen, g1, g2){
  const res = {visual:0,het:0,presente:0,super:0};
  // Recesivos
  if(genesRecesivos.includes(gen)){
    if(g1==="visual" && g2==="visual") res.visual=100;
    else if((g1==="visual" && g2==="het") || (g1==="het" && g2==="visual")) {res.visual=50; res.het=50;}
    else if(g1==="het" && g2==="het") {res.visual=25; res.het=50;}
    else if((g1==="visual" && !g2) || (!g1 && g2==="visual")) res.het=100;
    else if((g1==="het" && !g2) || (!g1 && g2==="het")) res.het=50;
  }
  // Codominantes
  else if(genesCodominantes.includes(gen)){
    if(g1==="presente" && g2==="") res.presente=50;
    else if(g1==="" && g2==="presente") res.presente=50;
    else if(g1==="presente" && g2==="presente") {res.presente=50; res.super=25;}
    else if((g1==="super" && g2==="") || (g1==="" && g2==="super")) res.presente=100;
    else if((g1==="super" && g2==="presente") || (g1==="presente" && g2==="super")) {res.presente=50; res.super=50;}
    else if(g1==="super" && g2==="super") res.super=100;
  }
  // Dominantes
  else if(genesDominantes.includes(gen)){
    if((g1==="presente" && g2==="") || (g1==="" && g2==="presente")) res.presente=50;
    else if(g1==="presente" && g2==="presente") res.presente=75;
  }
  return res;
}

function mostrarResultados(){
  const pId = parseInt(padreSelect.value);
  const mId = parseInt(madreSelect.value);
  if(!pId || !mId) return;
  const padre = progenitores.find(p=>p.id===pId);
  const madre = progenitores.find(p=>p.id===mId);

  const resultadosDiv = document.getElementById("resultados");
  resultadosDiv.innerHTML = "";

  const combosDiv = document.getElementById("combos");
  combosDiv.innerHTML = "";

  const rutasDiv = document.getElementById("rutas");
  rutasDiv.innerHTML = "";

  const poligenicosDiv = document.getElementById("poligenicos");
  poligenicosDiv.innerHTML = poligenicos.filter(g=>padre.genes[g]||madre.genes[g]).join(", ");

  // ---- Resultados Recesivos ----
  const resRecesivos = genesRecesivos.map(g=>{
    const porc = calcularPorcentaje(g, padre.genes[g], madre.genes[g]);
    if(!porc.visual && !porc.het) return null;
    return `${g}: ${porc.visual?porc.visual+"% visual":""} ${porc.het?porc.het+"% het":""}`.trim();
  }).filter(r=>r);
  if(resRecesivos.length) resultadosDiv.innerHTML += "<b>Recesivos:</b><br>"+resRecesivos.join("<br>");

  // ---- Resultados Codominantes ----
  const resCodom = genesCodominantes.map(g=>{
    const porc = calcularPorcentaje(g, padre.genes[g], madre.genes[g]);
    if(!porc.presente && !porc.super) return null;
    return `${g}: ${porc.presente?porc.presente+"% presente":""} ${porc.super?porc.super+"% super":""}`.trim();
  }).filter(r=>r);
  if(resCodom.length) resultadosDiv.innerHTML += "<br><b>Codominantes:</b><br>"+resCodom.join("<br>");

  // ---- Resultados Dominantes ----
  const resDom = genesDominantes.map(g=>{
    const porc = calcularPorcentaje(g, padre.genes[g], madre.genes[g]);
    if(!porc.presente) return null;
    return `${g}: ${porc.presente?porc.presente+"% presente":""}`.trim();
  }).filter(r=>r);
  if(resDom.length) resultadosDiv.innerHTML += "<br><b>Dominantes:</b><br>"+resDom.join("<br>");

  // ---- Combos logrados y porcentajes ----
  combos.forEach(c=>{
    let porcentaje = 1;
    let present = false;
    c.genes.forEach(gen=>{
      const porc = calcularPorcentaje(gen,padre.genes[gen],madre.genes[gen]);
      let p = porc.visual||porc.het||porc.presente||porc.super||0;
      if(p>0) present = true;
      porcentaje *= p/100;
    });
    if(present) combosDiv.innerHTML += `<div class="combo">✅ ${c.name} (${c.genes.join(" + ")}) ≈ ${(porcentaje*100).toFixed(1)}%</div>`;
  });

  // ---- Rutas a combos (genes faltantes) ----
  combos.forEach(c=>{
    let faltan = [];
    let presentes = [];
    c.genes.forEach(gen=>{
      const porc = calcularPorcentaje(gen,padre.genes[gen],madre.genes[gen]);
      let p = porc.visual||porc.het||porc.presente||porc.super||0;
      if(p==0) faltan.push(gen);
      else presentes.push(gen);
    });
    if(faltan.length>0 && presentes.length>0){
      rutasDiv.innerHTML += `<div class="combo">Ruta a ${c.name}: falta (${faltan.join(", ")}) | presentes (${presentes.join(", ")})</div>`;
    }
  });
}

padreSelect.addEventListener("change", mostrarResultados);
madreSelect.addEventListener("change", mostrarResultados);
</script>

</body>
</html>
