<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Genética Gecko Leopardo</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; margin:0; padding:15px; }
h2,h3,h4 { margin-top:15px; }
.section { background:#fff; padding:15px; margin-bottom:15px; border-radius:8px; }
.gene-box { border-bottom:1px solid #ddd; padding:10px 0; }
.row { display:flex; gap:10px; }
.col { flex:1; }
select { width:100%; padding:6px; }
.result-block { margin-top:10px; }
.combo { background:#e8f7e8; padding:10px; border-radius:6px; margin-bottom:8px; }
.route { background:#fff6e5; padding:10px; border-radius:6px; margin-bottom:8px; }
.warn { background:#fdeaea; padding:10px; border-radius:6px; }
.small { font-size:0.9em; color:#555; }
</style>
</head>
<body>

<h2>Calculadora Genética – Gecko Leopardo</h2>

<div class="section">
<h3>Selección genética</h3>
<div id="genes"></div>
<button onclick="calculate()">Calcular</button>
</div>

<div id="output"></div>

<script>
// ===================== DEFINICIÓN DE GENES =====================
const recessives = ["Tremper Albino","Bell Albino","Rainwater Albino","Eclipse","Blizzard","Murphy Patternless"];
const codominants = ["Mack Snow","Giant"];
const dominants = ["Enigma","White & Yellow"];
const polygenic = ["Mandarin / Tangerine","Blood","Blood Inferno","Blood Electric","Tornado"];

const combos = [
 {name:"RAPTOR", genes:["Tremper Albino","Eclipse","Murphy Patternless"], alias:"Tremper Eclipse Murphy"},
 {name:"Diablo Blanco", genes:["Tremper Albino","Blizzard","Eclipse"]},
 {name:"Radar", genes:["Bell Albino","Eclipse"]},
 {name:"Typhoon", genes:["Rainwater Albino","Eclipse"]},
 {name:"Universe", genes:["Mack Snow","Eclipse","White & Yellow"], super:true},
 {name:"Nova", genes:["Tremper Albino","Eclipse","Enigma"]}
];

// ===================== UI =====================
function geneRow(gene, type){
 let opts = [""];
 if(type==="rec") opts.push("het","visual");
 if(type==="codom") opts.push("presente","super");
 if(type==="dom") opts.push("presente");
 if(type==="poly") opts.push("presente");

 return `
 <div class="gene-box">
   <b>${gene}</b>
   <div class="row">
     <div class="col">
       Padre
       <select id="father_${gene}">
         ${opts.map(o=>`<option value="${o}">${o}</option>`).join("")}
       </select>
     </div>
     <div class="col">
       Madre
       <select id="mother_${gene}">
         ${opts.map(o=>`<option value="${o}">${o}</option>`).join("")}
       </select>
     </div>
   </div>
 </div>`;
}

function buildUI(){
 let g=document.getElementById("genes");
 g.innerHTML+="<h4>Genes recesivos</h4>";
 recessives.forEach(x=>g.innerHTML+=geneRow(x,"rec"));
 g.innerHTML+="<h4>Genes codominantes</h4>";
 codominants.forEach(x=>g.innerHTML+=geneRow(x,"codom"));
 g.innerHTML+="<h4>Genes dominantes</h4>";
 dominants.forEach(x=>g.innerHTML+=geneRow(x,"dom"));
 g.innerHTML+="<h4>Líneas poligénicas (informativas)</h4>";
 polygenic.forEach(x=>g.innerHTML+=geneRow(x,"poly"));
}
buildUI();

// ===================== CÁLCULO =====================
function get(p,g){ return document.getElementById(p+"_"+g).value; }

function calculate(){
 let out=document.getElementById("output");
 out.innerHTML="";
 let results={rec:{},cod:{},dom:{},poly:[]};

 recessives.forEach(g=>{
  let f=get("father",g), m=get("mother",g);
  let res=[];
  if(f==="visual"&&m==="visual") res.push(["Visual",4]);
  else if((f==="visual"&&m==="het")||(m==="visual"&&f==="het")) res.push(["Visual",2],["Het",2]);
  else if(f==="het"&&m==="het") res.push(["Visual",1],["Het",2]);
  else if((f==="visual"&&m==="")||(m==="visual"&&f==="")) res.push(["Het",4]);
  else if((f==="het"&&m==="")||(m==="het"&&f==="")) res.push(["Het",2]);
  if(res.length) results.rec[g]=res;
 });

 codominants.forEach(g=>{
  let f=get("father",g), m=get("mother",g);
  let res=[];
  if(f==="presente"&&m==="presente") res.push(["Super",1],["Presente",2]);
  else if((f==="presente"&&m==="")||(m==="presente"&&f==="")) res.push(["Presente",2]);
  else if((f==="super"&&m==="")||(m==="super"&&f==="")) res.push(["Presente",4]);
  else if((f==="super"&&m==="presente")||(m==="super"&&f==="presente")) res.push(["Super",2],["Presente",2]);
  else if(f==="super"&&m==="super") res.push(["Super",4]);
  if(res.length) results.cod[g]=res;
 });

 dominants.forEach(g=>{
  let f=get("father",g), m=get("mother",g);
  let res=[];
  if(f==="presente"&&m==="presente") res.push(["Presente",3]);
  else if((f==="presente"&&m==="")||(m==="presente"&&f==="")) res.push(["Presente",2]);
  if(res.length) results.dom[g]=res;
 });

 polygenic.forEach(g=>{
  if(get("father",g)==="presente"||get("mother",g)==="presente") results.poly.push(g);
 });

 render(results);
}

// ===================== RENDER =====================
function render(r){
 let o=document.getElementById("output");

 let geneCount=Object.keys(r.rec).length+Object.keys(r.cod).length+Object.keys(r.dom).length;
 o.innerHTML+=`<div class="section"><b>Resumen</b><br>
 Genes activos: ${geneCount}
 </div>`;

 function block(title,data){
  let html="";
  for(let g in data){
   html+=`<b>${g}</b><br>`;
   data[g].forEach(x=>html+=`• ${x[1]}/4 ${x[0]} (${x[1]*25}%)<br>`);
   html+="<br>";
  }
  if(html) o.innerHTML+=`<div class="section"><h3>${title}</h3>${html}</div>`;
 }

 block("Recesivos",r.rec);
 block("Codominantes",r.cod);
 block("Dominantes",r.dom);

 let comboHTML="", routeHTML="";
 combos.forEach(c=>{
  let have=c.genes.filter(g=>r.rec[g]||r.cod[g]||r.dom[g]);
  if(have.length===c.genes.length){
   comboHTML+=`<div class="combo">✅ ${c.name}<br>${c.genes.join("<br>")}</div>`;
  } else if(have.length>=1){
   let missing=c.genes.filter(g=>!have.includes(g));
   routeHTML+=`<div class="route">➜ Ruta a ${c.name}<br>Faltan:<br>${missing.join("<br>")}</div>`;
  }
 });

 if(comboHTML) o.innerHTML+=`<div class="section"><h3>Combos logrados</h3>${comboHTML}</div>`;
 if(routeHTML) o.innerHTML+=`<div class="section"><h3>Rutas a combos</h3>${routeHTML}</div>`;

 if(r.poly.length){
  o.innerHTML+=`<div class="section"><h3>Líneas poligénicas</h3>${r.poly.join("<br>")}
  <div class="small">No influyen en porcentajes genéticos</div></div>`;
 }
}
</script>
</body>
</html>
