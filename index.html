<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora Genética Gecko Leopardo</title>
<style>
body { font-family: Arial, sans-serif; padding: 15px; }
select, button { margin: 4px 0; width: 100%; }
.result { white-space: pre-line; margin-top: 15px; }
h2 { margin-top: 25px; }
</style>
</head>

<body>

<h1>Calculadora Genética – Gecko Leopardo</h1>

<h2>Recesivos (estado de los padres)</h2>

<div id="genes"></div>

<button onclick="calcular()">Calcular</button>

<div id="resultado" class="result"></div>

<script>
// ======================
// CONFIGURACIÓN GENES
// ======================

const recesivos = [
  "Tremper Albino",
  "Bell Albino",
  "Rainwater Albino",
  "Eclipse",
  "Blizzard",
  "Murphy Patternless"
];

const dominantes = [
  "Enigma",
  "White & Yellow",
  "Mack Snow",
  "Super Mack Snow"
];

// ======================
// UI DINÁMICA
// ======================

const geneDiv = document.getElementById("genes");

recesivos.forEach(g => crearSelect(g));
dominantes.forEach(g => crearSelect(g, true));

function crearSelect(nombre, dom = false) {
  geneDiv.innerHTML += `
    <label>${nombre}</label>
    <select id="${nombre}_padre">
      ${dom ? opcionesDom() : opcionesRec()}
    </select>
    <select id="${nombre}_madre">
      ${dom ? opcionesDom() : opcionesRec()}
    </select>
    <hr>
  `;
}

function opcionesRec() {
  return `
    <option value="normal">Normal</option>
    <option value="het">Het</option>
    <option value="pos50">Pos Het 50%</option>
    <option value="pos66">Pos Het 66%</option>
    <option value="visual">Visual</option>
  `;
}

function opcionesDom() {
  return `
    <option value="ausente">Ausente</option>
    <option value="presente">Presente</option>
  `;
}

// ======================
// LÓGICA GENÉTICA
// ======================

function estadoRecesivo(p, m) {
  if (p === "visual" && m === "visual") return { visual: 100 };
  if ((p === "visual" && m === "het") || (p === "het" && m === "visual"))
    return { visual: 50, het: 50 };
  if (p === "het" && m === "het")
    return { visual: 25, het: 50, normal: 25 };
  if ((p === "visual" && m === "normal") || (p === "normal" && m === "visual"))
    return { het: 100 };
  if ((p === "het" && m === "normal") || (p === "normal" && m === "het"))
    return { pos50: 50 };
  if (p === "pos66" || m === "pos66")
    return { pos66: 66 };
  return { normal: 100 };
}

// ======================
// COMBOS DEFINIDOS
// ======================

const combos = [
  { nombre:"BEE", alias:["Black Eyed Enigma"],
    requiere:{ "Enigma":"presente", "Eclipse":"visual" } },

  { nombre:"Black Hole",
    requiere:{ "Mack Snow":"presente", "Enigma":"presente", "Eclipse":"visual" } },

  { nombre:"Total Eclipse", alias:["Galaxy"],
    requiere:{ "Super Mack Snow":"presente", "Eclipse":"visual" } },

  { nombre:"Universe",
    requiere:{ "Super Mack Snow":"presente", "Eclipse":"visual", "White & Yellow":"presente" } },

  { nombre:"Banana Blizzard",
    requiere:{ "Murphy Patternless":"visual", "Blizzard":"visual" } },

  { nombre:"Super Platinum",
    requiere:{ "Super Mack Snow":"presente", "Murphy Patternless":"visual" } },

  { nombre:"RAPTOR",
    requiere:{ "Tremper Albino":"visual", "Eclipse":"visual", "Murphy Patternless":"visual" } },

  { nombre:"Ember",
    requiere:{ "Tremper Albino":"visual", "Eclipse":"visual", "Murphy Patternless":"visual" } },

  { nombre:"Snowflake", alias:["Snow Ember"],
    requiere:{ "Mack Snow":"presente", "Tremper Albino":"visual", "Eclipse":"visual", "Murphy Patternless":"visual" } },

  { nombre:"Blazing Blizzard",
    requiere:{ "Tremper Albino":"visual", "Blizzard":"visual" } },

  { nombre:"Diablo Blanco",
    requiere:{ "Tremper Albino":"visual", "Blizzard":"visual", "Eclipse":"visual" },
    advertencia:"Eclipse puede quedar oculto por Blizzard" },

  { nombre:"Nova",
    requiere:{ "Tremper Albino":"visual", "Eclipse":"visual", "Enigma":"presente" } },

  { nombre:"Super Nova",
    requiere:{ "Super Mack Snow":"presente", "Tremper Albino":"visual", "Eclipse":"visual", "Enigma":"presente" } },

  { nombre:"Dreamsickle",
    requiere:{ "Mack Snow":"presente", "Tremper Albino":"visual", "Eclipse":"visual", "Enigma":"presente" } },

  { nombre:"Radar",
    requiere:{ "Bell Albino":"visual", "Eclipse":"visual" } },

  { nombre:"Stealth",
    requiere:{ "Mack Snow":"presente", "Enigma":"presente", "Bell Albino":"visual", "Eclipse":"visual" } },

  { nombre:"Super Stealth",
    requiere:{ "Super Mack Snow":"presente", "Enigma":"presente", "Bell Albino":"visual", "Eclipse":"visual" } },

  { nombre:"White Knight",
    requiere:{ "Bell Albino":"visual", "Blizzard":"visual", "Eclipse":"visual" },
    advertencia:"Eclipse puede quedar oculto por Blizzard" },

  { nombre:"Typhoon",
    requiere:{ "Rainwater Albino":"visual", "Eclipse":"visual" } },

  { nombre:"Cyclone",
    requiere:{ "Rainwater Albino":"visual", "Eclipse":"visual", "Murphy Patternless":"visual" } }
];

// ======================
// CÁLCULO FINAL
// ======================

function calcular() {
  let salida = "RESULTADOS GENÉTICOS\n\n";

  const estadoGenes = {};

  recesivos.forEach(g => {
    const p = document.getElementById(g+"_padre").value;
    const m = document.getElementById(g+"_madre").value;
    estadoGenes[g] = estadoRecesivo(p, m);
    salida += `${g}: ${JSON.stringify(estadoGenes[g])}\n`;
  });

  dominantes.forEach(g => {
    const p = document.getElementById(g+"_padre").value;
    const m = document.getElementById(g+"_madre").value;
    estadoGenes[g] = (p === "presente" || m === "presente") ? "presente" : "ausente";
  });

  salida += "\nCOMBOS DETECTADOS:\n";

  combos.forEach(c => {
    let cumple = true;
    let faltan = [];

    for (let g in c.requiere) {
      if (c.requiere[g] === "visual") {
        if (!estadoGenes[g] || !estadoGenes[g].visual) {
          cumple = false;
          faltan.push(g);
        }
      } else {
        if (estadoGenes[g] !== "presente") {
          cumple = false;
          faltan.push(g);
        }
      }
    }

    if (cumple) {
      salida += `✅ ${c.nombre}`;
      if (c.alias) salida += ` (${c.alias.join(", ")})`;
      salida += "\n";
      if (c.advertencia) salida += `⚠️ ${c.advertencia}\n`;
    } else if (faltan.length < Object.keys(c.requiere).length) {
      salida += `⚠️ Ruta a ${c.nombre} — falta: ${faltan.join(", ")}\n`;
    }
  });

  document.getElementById("resultado").textContent = salida;
}
</script>

</body>
</html>
