<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Genética Gecko Leopardo</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
h2 { margin-top: 20px; }
section { margin-bottom: 20px; }
label { display: block; margin-top: 10px; }
select { width: 200px; margin-top: 5px; }
.result { border: 1px solid #ccc; padding: 10px; margin-top: 10px; min-height: 20px; }
.combo { margin-left: 20px; }
</style>
</head>
<body>

<h1>Calculadora Genética Gecko Leopardo</h1>

<section>
  <h2>Selecciona los progenitores</h2>
  <label>Macho
    <select id="padre">
      <option value="">Selecciona macho</option>
    </select>
  </label>
  <label>Hembra
    <select id="madre">
      <option value="">Selecciona hembra</option>
    </select>
  </label>
</section>

<section>
  <h2>Resultados Genéticos</h2>
  <div id="resultados" class="result"></div>
</section>

<section>
  <h2>Combos logrados</h2>
  <div id="combos" class="result"></div>
</section>

<section>
  <h2>Rutas a combos</h2>
  <div id="rutas" class="result"></div>
</section>

<section>
  <h2>Líneas poligénicas</h2>
  <div id="poligenicos" class="result"></div>
</section>

<script>
// ====== Datos base ======
const genesRecesivos = ["tremper","bell","rain","eclipse","blizzard","murphy"];
const genesCodominantes = ["mack","superMack","giant"];
const genesDominantes = ["enigma","wy","whiteYellow"];
const poligenicos = ["mandarin","tangerine","blood","bloodInferno","bloodElectric","tornado"];

const combos = [
  {name:"BEE", genes:["enigma","eclipse"]},
  {name:"Black Hole", genes:["mack","enigma","eclipse"]},
  {name:"Total Eclipse", genes:["superMack","eclipse"]},
  {name:"Universe", genes:["superMack","eclipse","wy"]},
  {name:"Banana Blizzard", genes:["murphy","blizzard"]},
  {name:"Super Platinum", genes:["superMack","murphy"]},
  {name:"Raptor", genes:["tremper","eclipse","murphy"]},
  {name:"Aptor", genes:["tremper","murphy"]},
  {name:"Ember", genes:["tremper","eclipse","murphy"]},
  {name:"Snowflake", genes:["mack","tremper","eclipse","murphy"]},
  {name:"Blazing Blizzard", genes:["blizzard"]},
  {name:"Diablo Blanco", genes:["tremper","blizzard","eclipse"]},
  {name:"Nova", genes:["tremper","eclipse","enigma"]},
  {name:"Super Nova", genes:["superMack","tremper","eclipse","enigma"]},
  {name:"Dreamsickle", genes:["mack","tremper","eclipse","enigma"]},
  {name:"Radar", genes:["bell","eclipse"]},
  {name:"Stealth", genes:["mack","enigma","bell","eclipse"]},
  {name:"Super Stealth", genes:["superMack","radar","enigma"]},
  {name:"White Knight", genes:["bell","eclipse","blizzard"]},
  {name:"Typhoon", genes:["rain","eclipse"]},
  {name:"Cyclone", genes:["rain","eclipse","murphy"]}
];

const progenitores = [
  {id:1, nombre:"Gecko1", genes:{tremper:"het",eclipse:"visual",mack:"presente",superMack:"",wy:"",giant:"",blizzard:"",murphy:"",bell:"",rain:"",enigma:"presente",whiteYellow:""}},
  {id:2, nombre:"Gecko2", genes:{tremper:"",eclipse:"het",mack:"presente",superMack:"super",wy:"presente",giant:"giant",blizzard:"het",murphy:"het",bell:"",rain:"",enigma:"",whiteYellow:""}}  
];

// ====== Llenar selects ======
const padreSelect = document.getElementById("padre");
const madreSelect = document.getElementById("madre");
progenitores.forEach(p => {
  padreSelect.innerHTML += `<option value="${p.id}">${p.nombre}</option>`;
  madreSelect.innerHTML += `<option value="${p.id}">${p.nombre}</option>`;
});

// ====== Funciones ======
function getPorcentaje(gen, g1, g2){
  g1 = g1||""; g2=g2||"";
  if(genesRecesivos.includes(gen)){
    if(g1==="visual" && g2==="visual") return {visual:100};
    if((g1==="visual" && g2==="het")||(g1==="het" && g2==="visual")) return {visual:50,het:50};
    if(g1==="het" && g2==="het") return {visual:25,het:50};
    if((g1==="visual" && !g2)||(!g1 && g2==="visual")) return {het:100};
    if((g1==="het" && !g2)||(!g1 && g2==="het")) return {het:50};
  }
  if(genesCodominantes.includes(gen)){
    if((g1==="presente" && g2==="")||(g1==="" && g2==="presente")) return {presente:50};
    if(g1==="presente" && g2==="presente") return {presente:50,super:25};
    if((g1==="super" && g2==="")||(g1==="" && g2==="super")) return {presente:100};
    if((g1==="super" && g2==="presente")||(g1==="presente" && g2==="super")) return {presente:50,super:50};
    if(g1==="super" && g2==="super") return {super:100};
  }
  if(genesDominantes.includes(gen)){
    if((g1==="presente" && g2==="")||(g1==="" && g2==="presente")) return {presente:50};
    if(g1==="presente" && g2==="presente") return {presente:75};
  }
  return {};
}

// Calcula porcentaje general de combo
function porcentajeCombo(combo, padre, madre){
  let total = combo.genes.length;
  let suma = 0;
  combo.genes.forEach(gen=>{
    const porc = getPorcentaje(gen,padre.genes[gen],madre.genes[gen]);
    if(Object.keys(porc).length>0){
      // Tomamos el valor máximo de cada gen como aproximación
      suma += Math.max(...Object.values(porc));
    }
  });
  return Math.round(suma/total);
}

function mostrarResultados(){
  const pId = parseInt(padreSelect.value);
  const mId = parseInt(madreSelect.value);
  if(!pId || !mId) return;
  const padre = progenitores.find(p=>p.id===pId);
  const madre = progenitores.find(p=>p.id===mId);

  const resultadosDiv = document.getElementById("resultados");
  const combosDiv = document.getElementById("combos");
  const rutasDiv = document.getElementById("rutas");
  const poligenicosDiv = document.getElementById("poligenicos");

  resultadosDiv.innerHTML = combosDiv.innerHTML = rutasDiv.innerHTML = "";
  poligenicosDiv.innerHTML = poligenicos.filter(g=>padre.genes[g]||madre.genes[g]).join(", ");

  // Recesivos
  genesRecesivos.forEach(g=>{
    const porc = getPorcentaje(g,padre.genes[g],madre.genes[g]);
    if(Object.keys(porc).length) resultadosDiv.innerHTML += `<div>${g}: ${Object.entries(porc).map(([k,v])=>v+"% "+k).join(", ")}</div>`;
  });

  // Codominantes
  genesCodominantes.forEach(g=>{
    const porc = getPorcentaje(g,padre.genes[g],madre.genes[g]);
    if(Object.keys(porc).length) resultadosDiv.innerHTML += `<div>${g}: ${Object.entries(porc).map(([k,v])=>v+"% "+k).join(", ")}</div>`;
  });

  // Dominantes
  genesDominantes.forEach(g=>{
    const porc = getPorcentaje(g,padre.genes[g],madre.genes[g]);
    if(Object.keys(porc).length) resultadosDiv.innerHTML += `<div>${g}: ${Object.entries(porc).map(([k,v])=>v+"% "+k).join(", ")}</div>`;
  });

  // Combos logrados
  combos.forEach(c=>{
    const porcCombo = porcentajeCombo(c,padre,madre);
    const tiene = porcCombo > 0;
    if(tiene) combosDiv.innerHTML += `<div class="combo">✅ ${c.name} (${c.genes.join(" + ")}) ${porcCombo}%</div>`;
  });

  // Rutas a combos
  combos.forEach(c=>{
    let faltan = [], presentes=[];
    c.genes.forEach(gen=>{
      const porc = getPorcentaje(gen,padre.genes[gen],madre.genes[gen]);
      if(Object.keys(porc).length>0) presentes.push(gen);
      else faltan.push(gen);
    });
    if(faltan.length>0 && presentes.length>0){
      rutasDiv.innerHTML += `<div class="combo">Ruta a ${c.name}: falta (${faltan.join(", ")}) | presentes (${presentes.join(", ")})</div>`;
    }
  });
}

padreSelect.addEventListener("change", mostrarResultados);
madreSelect.addEventListener("change", mostrarResultados);
</script>
</body>
</html>
