<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Genética Gecko Leopardo</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; margin:0; padding:15px; }
h2,h3 { margin-top:20px; }
.section { background:#fff; padding:15px; margin-bottom:15px; border-radius:8px; }
label { display:block; margin:6px 0; }
select { width:100%; padding:6px; margin-bottom:10px; }
.result-block { margin-top:10px; }
.combo { background:#e8f7e8; padding:10px; border-radius:6px; margin-bottom:8px; }
.route { background:#fff6e5; padding:10px; border-radius:6px; margin-bottom:8px; }
.warn { background:#fdeaea; padding:10px; border-radius:6px; }
.small { font-size:0.9em; color:#555; }
</style>
</head>
<body>

<h2>Calculadora Genética – Gecko Leopardo</h2>

<div class="section">
<h3>Padre</h3>
<div id="father"></div>
<h3>Madre</h3>
<div id="mother"></div>
<button onclick="calculate()">Calcular</button>
</div>

<div id="output"></div>

<script>
// ===================== DEFINICIÓN DE GENES =====================
const recessives = ["Tremper Albino","Bell Albino","Rainwater Albino","Eclipse","Blizzard","Murphy Patternless"];
const codominants = ["Mack Snow","Giant"];
const dominants = ["Enigma","White & Yellow"];
const polygenic = ["Mandarin / Tangerine","Blood","Blood Inferno","Blood Electric","Tornado"];

const combos = [
 {name:"RAPTOR", genes:["Tremper Albino","Eclipse","Murphy Patternless"], alias:"Tremper Eclipse Murphy"},
 {name:"Diablo Blanco", genes:["Tremper Albino","Blizzard","Eclipse"]},
 {name:"Radar", genes:["Bell Albino","Eclipse"]},
 {name:"Typhoon", genes:["Rainwater Albino","Eclipse"]},
 {name:"Universe", genes:["Mack Snow","Eclipse","White & Yellow"], super:true},
 {name:"Nova", genes:["Tremper Albino","Eclipse","Enigma"]}
];

// ===================== UI =====================
function geneSelect(type, gene, parent){
 let opts = ["","het","visual"];
 if(type==="codom") opts = ["","presente","super"];
 if(type==="dom") opts = ["","presente"];
 if(type==="poly") opts = ["","presente"];
 return `
 <label>${gene}
 <select id="${parent}_${gene}">
 ${opts.map(o=>`<option value="${o}">${o}</option>`).join("")}
 </select></label>`;
}

function buildUI(){
 ["father","mother"].forEach(p=>{
  let div=document.getElementById(p);
  recessives.forEach(g=>div.innerHTML+=geneSelect("rec",g,p));
  codominants.forEach(g=>div.innerHTML+=geneSelect("codom",g,p));
  dominants.forEach(g=>div.innerHTML+=geneSelect("dom",g,p));
  polygenic.forEach(g=>div.innerHTML+=geneSelect("poly",g,p));
 });
}
buildUI();

// ===================== CÁLCULO =====================
function calculate(){
 let out=document.getElementById("output");
 out.innerHTML="";
 let results={rec:{},cod:{},dom:{},poly:[]};

 function get(p,g){ return document.getElementById(p+"_"+g).value; }

 recessives.forEach(g=>{
  let f=get("father",g), m=get("mother",g);
  let res=[];
  if(f==="visual"&&m==="visual") res.push(["Visual",4]);
  else if((f==="visual"&&m==="het")||(m==="visual"&&f==="het")) res.push(["Visual",2],["Het",2]);
  else if(f==="het"&&m==="het") res.push(["Visual",1],["Het",2]);
  else if((f==="visual"&&m==="")||(m==="visual"&&f==="")) res.push(["Het",4]);
  else if((f==="het"&&m==="")||(m==="het"&&f==="")) res.push(["Het",2]);
  if(res.length) results.rec[g]=res;
 });

 codominants.forEach(g=>{
  let f=get("father",g), m=get("mother",g);
  let res=[];
  if(f==="presente"&&m==="presente") res.push(["Super",1],["Presente",2]);
  else if((f==="presente"&&m==="")||(m==="presente"&&f==="")) res.push(["Presente",2]);
  else if((f==="super"&&m==="")||(m==="super"&&f==="")) res.push(["Presente",4]);
  else if((f==="super"&&m==="presente")||(m==="super"&&f==="presente")) res.push(["Super",2],["Presente",2]);
  else if(f==="super"&&m==="super") res.push(["Super",4]);
  if(res.length) results.cod[g]=res;
 });

 dominants.forEach(g=>{
  let f=get("father",g), m=get("mother",g);
  let res=[];
  if(f==="presente"&&m==="presente") res.push(["Presente",3]);
  else if((f==="presente"&&m==="")||(m==="presente"&&f==="")) res.push(["Presente",2]);
  if(res.length) results.dom[g]=res;
 });

 polygenic.forEach(g=>{
  if(get("father",g)==="presente"||get("mother",g)==="presente") results.poly.push(g);
 });

 render(results);
}

// ===================== RENDER =====================
function render(r){
 let o=document.getElementById("output");

 // Resumen
 let geneCount=Object.keys(r.rec).length+Object.keys(r.cod).length+Object.keys(r.dom).length;
 o.innerHTML+=`<div class="section"><b>Resumen</b><br>
 Genes activos: ${geneCount}<br>
 Combos posibles: ${combos.length}
 </div>`;

 // Resultados
 function block(title,data){
  let html="";
  for(let g in data){
   html+=`<b>${g}</b><br>`;
   data[g].forEach(x=>{
    html+=`• ${x[1]}/4 ${x[0]} (${x[1]*25}%)<br>`;
   });
   html+="<br>";
  }
  if(html) o.innerHTML+=`<div class="section"><h3>${title}</h3>${html}</div>`;
 }

 block("Recesivos",r.rec);
 block("Codominantes",r.cod);
 block("Dominantes",r.dom);

 // Combos y rutas
 let comboHTML="", routeHTML="";
 combos.forEach(c=>{
  let have=c.genes.filter(g=>r.rec[g]||r.cod[g]||r.dom[g]);
  if(have.length===c.genes.length){
   comboHTML+=`<div class="combo">✅ ${c.name}<br>Componentes:<br>${c.genes.join("<br>")}</div>`;
  } else if(have.length>=1){
   let missing=c.genes.filter(g=>!have.includes(g));
   routeHTML+=`<div class="route">➜ Ruta a ${c.name}<br>Faltan:<br>${missing.join("<br>")}</div>`;
  }
 });

 if(comboHTML) o.innerHTML+=`<div class="section"><h3>Combos logrados</h3>${comboHTML}</div>`;
 if(routeHTML) o.innerHTML+=`<div class="section"><h3>Rutas a combos</h3>${routeHTML}</div>`;

 // Poligénicos
 if(r.poly.length){
  o.innerHTML+=`<div class="section"><h3>Líneas poligénicas</h3>${r.poly.join("<br>")}
  <div class="small">No influyen en porcentajes genéticos</div></div>`;
 }
}
</script>
</body>
</html>
