<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora Genética – Gecko Leopardo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<h1>Calculadora Genética – Gecko Leopardo</h1>

<h2>Albinismo</h2>

<h3>Tremper</h3>
Padre:
<select id="padre_tremper">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_tremper">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h3>Bell</h3>
Padre:
<select id="padre_bell">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_bell">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h3>Rainwater</h3>
Padre:
<select id="padre_rainwater">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_rainwater">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h2>Ojos</h2>

<h3>Eclipse</h3>
Padre:
<select id="padre_eclipse">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_eclipse">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h2>Codominantes</h2>

<h3>Mack Snow</h3>
Padre:
<select id="padre_mack">
  <option value="normal">Normal</option>
  <option value="het">Mack Snow</option>
  <option value="super">Super Mack Snow</option>
</select>
Madre:
<select id="madre_mack">
  <option value="normal">Normal</option>
  <option value="het">Mack Snow</option>
  <option value="super">Super Mack Snow</option>
</select>

<h3>Giant</h3>
Padre:
<select id="padre_giant">
  <option value="normal">Normal</option>
  <option value="het">Giant</option>
  <option value="super">Super Giant</option>
</select>
Madre:
<select id="madre_giant">
  <option value="normal">Normal</option>
  <option value="het">Giant</option>
  <option value="super">Super Giant</option>
</select>

<br><br>
<button onclick="calcular()">Calcular</button>

<h2>Resultado</h2>
<pre id="resultado"></pre>

<script src="genetics.js"></script>

<script>
function calcular() {
  let t = "";

  /* =======================
     PASO 2 – VALIDACIÓN ALBINISMO
     ======================= */
  const albinismos = [
    { nombre: "Tremper", padre: padre_tremper.value, madre: madre_tremper.value },
    { nombre: "Bell", padre: padre_bell.value, madre: madre_bell.value },
    { nombre: "Rainwater", padre: padre_rainwater.value, madre: madre_rainwater.value }
  ];

  const activos = albinismos.filter(a =>
    a.padre !== "normal" || a.madre !== "normal"
  );

  if (activos.length > 1) {
    document.getElementById("resultado").textContent =
      "⚠️ CRUCE INVÁLIDO\n\n" +
      "Los albinismos NO se combinan entre sí.\n\n" +
      "Detectados:\n" +
      activos.map(a => "- " + a.nombre).join("\n");
    return;
  }

  /* =======================
     FUNCIÓN DE IMPRESIÓN
     ======================= */
  function bloque(nombre, res, padre, madre) {
    if (padre === "normal" && madre === "normal") return;

    t += nombre + "\n";

    if (res.resultado.normal !== undefined && res.resultado.normal > 0)
      t += "Normal: " + res.resultado.normal + "%\n";

    if (res.resultado.het !== undefined && res.resultado.het > 0)
      t += "Het: " + res.resultado.het + "%\n";

    if (res.resultado.visual !== undefined && res.resultado.visual > 0)
      t += "Visual: " + res.resultado.visual + "%\n";

    if (res.resultado.super !== undefined && res.resultado.super > 0)
      t += "Super: " + res.resultado.super + "%\n";

    t += "\n";
  }

  const tremper = calcularGen("tremper", padre_tremper.value, madre_tremper.value);
  const eclipse = calcularGen("eclipse", padre_eclipse.value, madre_eclipse.value);
  const mack = calcularGen("mack_snow", padre_mack.value, madre_mack.value);

  bloque("Tremper", tremper, padre_tremper.value, madre_tremper.value);
  bloque("Eclipse", eclipse, padre_eclipse.value, madre_eclipse.value);
  bloque("Mack Snow", mack, padre_mack.value, madre_mack.value);

  /* =======================
     PASO 3 – DETECCIÓN DE COMBOS
     ======================= */
  let combos = [];

  if (
    tremper.resultado.visual === 100 &&
    eclipse.resultado.visual === 100
  ) {
    combos.push("RAPTOR");
  }

  if (
    tremper.resultado.visual === 100 &&
    eclipse.resultado.visual === 100 &&
    mack.resultado.super === 100
  ) {
    combos.push("SUPER RAPTOR");
  }

  if (
    mack.resultado.super === 100 &&
    tremper.resultado.visual === 100 &&
    eclipse.resultado.visual === 100
  ) {
    combos.push("DIABLO BLANCO");
  }

  if (combos.length > 0) {
    t += "COMBOS DETECTADOS\n";
    combos.forEach(c => t += "- " + c + "\n");
  }

  document.getElementById("resultado").textContent =
    t || "No hay genes activos en este cruce.";
}
</script>

</body>
</html>
