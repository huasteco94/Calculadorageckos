<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora Genética Gecko Leopardo</title>
<style>
body { font-family: Arial, sans-serif; padding: 15px; }
select, button { margin: 4px 0; width: 100%; }
.result { white-space: pre-line; margin-top: 15px; }
h2 { margin-top: 25px; }
</style>
</head>

<body>

<h1>Calculadora Genética – Gecko Leopardo</h1>

<h2>Genética de los padres</h2>

<div id="genes"></div>

<button onclick="calcular()">Calcular</button>

<div id="resultado" class="result"></div>

<script>
// ======================
// DEFINICIÓN DE GENES
// ======================

const recesivos = [
  { key:"tremper", label:"Tremper Albino" },
  { key:"bell", label:"Bell Albino" },
  { key:"rainwater", label:"Rainwater Albino" },
  { key:"eclipse", label:"Eclipse" },
  { key:"blizzard", label:"Blizzard" },
  { key:"murphy", label:"Murphy Patternless" }
];

const dominantes = [
  { key:"enigma", label:"Enigma" },
  { key:"wy", label:"White & Yellow" },
  { key:"mack", label:"Mack Snow" },
  { key:"supermack", label:"Super Mack Snow" }
];

// ======================
// UI
// ======================

const geneDiv = document.getElementById("genes");

recesivos.forEach(g => crearSelect(g, false));
dominantes.forEach(g => crearSelect(g, true));

function crearSelect(gen, dominante) {
  geneDiv.innerHTML += `
    <label><strong>${gen.label}</strong></label>
    <select id="${gen.key}_padre">
      ${dominante ? opcionesDom() : opcionesRec()}
    </select>
    <select id="${gen.key}_madre">
      ${dominante ? opcionesDom() : opcionesRec()}
    </select>
    <hr>
  `;
}

function opcionesRec() {
  return `
    <option value="normal">Normal</option>
    <option value="het">Het</option>
    <option value="visual">Visual</option>
  `;
}

function opcionesDom() {
  return `
    <option value="ausente">Ausente</option>
    <option value="presente">Presente</option>
  `;
}

// ======================
// GENÉTICA
// ======================

function calcRecesivo(p, m) {
  if (p === "visual" && m === "visual") return { visual:100 };
  if ((p === "visual" && m === "het") || (p === "het" && m === "visual"))
    return { visual:50, het:50 };
  if (p === "het" && m === "het")
    return { visual:25, het:50, normal:25 };
  if ((p === "visual" && m === "normal") || (p === "normal" && m === "visual"))
    return { het:100 };
  return { normal:100 };
}

// ======================
// COMBOS (Mendelianos)
// ======================

const combos = [
  { nombre:"RAPTOR", requiere:{ tremper:"visual", eclipse:"visual", murphy:"visual" }},
  { nombre:"Diablo Blanco", requiere:{ tremper:"visual", blizzard:"visual", eclipse:"visual" },
    advertencia:"Eclipse puede quedar oculto por Blizzard" },
  { nombre:"Nova", requiere:{ tremper:"visual", eclipse:"visual", enigma:"presente" }},
  { nombre:"Radar", requiere:{ bell:"visual", eclipse:"visual" }},
  { nombre:"Typhoon", requiere:{ rainwater:"visual", eclipse:"visual" }},
  { nombre:"Universe", requiere:{ supermack:"presente", eclipse:"visual", wy:"presente" }}
];

// ======================
// CÁLCULO
// ======================

function calcular() {
  let salida = "RESULTADOS\n\n";
  const estado = {};

  recesivos.forEach(g => {
    const p = document.getElementById(g.key+"_padre").value;
    const m = document.getElementById(g.key+"_madre").value;
    estado[g.key] = calcRecesivo(p, m);
    salida += `${g.label}: ${JSON.stringify(estado[g.key])}\n`;
  });

  dominantes.forEach(g => {
    const p = document.getElementById(g.key+"_padre").value;
    const m = document.getElementById(g.key+"_madre").value;
    estado[g.key] = (p === "presente" || m === "presente") ? "presente" : "ausente";
  });

  salida += "\nCOMBOS:\n";

  combos.forEach(c => {
    let ok = true;
    let faltan = [];

    for (let g in c.requiere) {
      if (c.requiere[g] === "visual") {
        if (!estado[g] || !estado[g].visual) {
          ok = false; faltan.push(g);
        }
      } else {
        if (estado[g] !== "presente") {
          ok = false; faltan.push(g);
        }
      }
    }

    if (ok) {
      salida += `✅ ${c.nombre}\n`;
      if (c.advertencia) salida += `⚠️ ${c.advertencia}\n`;
    } else if (faltan.length < Object.keys(c.requiere).length) {
      salida += `↪ Ruta a ${c.nombre} (falta: ${faltan.join(", ")})\n`;
    }
  });

  document.getElementById("resultado").textContent = salida;
}
</script>

</body>
</html>
