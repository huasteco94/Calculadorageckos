<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora Genética – Gecko Leopardo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<h1>Calculadora Genética – Gecko Leopardo</h1>

<h2>Albinismo</h2>

<h3>Tremper</h3>
Padre:
<select id="padre_tremper">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_tremper">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h3>Bell</h3>
Padre:
<select id="padre_bell">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_bell">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h3>Rainwater</h3>
Padre:
<select id="padre_rainwater">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_rainwater">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h2>Ojos</h2>

<h3>Eclipse</h3>
Padre:
<select id="padre_eclipse">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>
Madre:
<select id="madre_eclipse">
  <option value="normal">Normal</option>
  <option value="het">Het</option>
  <option value="visual">Visual</option>
</select>

<h2>Codominantes</h2>

<h3>Mack Snow</h3>
Padre:
<select id="padre_mack">
  <option value="normal">Normal</option>
  <option value="het">Mack Snow</option>
  <option value="super">Super Mack Snow</option>
</select>
Madre:
<select id="madre_mack">
  <option value="normal">Normal</option>
  <option value="het">Mack Snow</option>
  <option value="super">Super Mack Snow</option>
</select>

<h3>Giant</h3>
Padre:
<select id="padre_giant">
  <option value="normal">Normal</option>
  <option value="het">Giant</option>
  <option value="super">Super Giant</option>
</select>
Madre:
<select id="madre_giant">
  <option value="normal">Normal</option>
  <option value="het">Giant</option>
  <option value="super">Super Giant</option>
</select>

<br><br>
<button onclick="calcular()">Calcular</button>

<h2>Resultado</h2>
<pre id="resultado"></pre>

<script src="genetics.js"></script>

<script>
function calcular() {
  let t = "";

  /* =======================
     PASO 2 – VALIDACIÓN ALBINISMO
     ======================= */
  const albinismos = [
    { nombre: "Tremper", padre: padre_tremper.value, madre: madre_tremper.value },
    { nombre: "Bell", padre: padre_bell.value, madre: madre_bell.value },
    { nombre: "Rainwater", padre: padre_rainwater.value, madre: madre_rainwater.value }
  ];

  const activos = albinismos.filter(a =>
    a.padre !== "normal" || a.madre !== "normal"
  );

  if (activos.length > 1) {
    resultado.textContent =
      "⚠️ CRUCE INVÁLIDO\n\n" +
      "Los albinismos NO se combinan entre sí.\n\n" +
      "Detectados:\n" +
      activos.map(a => "- " + a.nombre).join("\n");
    return;
  }

  /* =======================
     FUNCIÓN DE IMPRESIÓN
     ======================= */
  function bloque(nombre, res, padre, madre) {
    if (!res || !res.resultado) return;
    if (padre === "normal" && madre === "normal") return;

    t += nombre + "\n";

    for (const key in res.resultado) {
      if (res.resultado[key] > 0) {
        t += key.charAt(0).toUpperCase() + key.slice(1) +
             ": " + res.resultado[key] + "%\n";
      }
    }
    t += "\n";
  }

  const tremper = calcularGen("tremper", padre_tremper.value, madre_tremper.value);
  const bell = calcularGen("bell", padre_bell.value, madre_bell.value);
  const rain = calcularGen("rainwater", padre_rainwater.value, madre_rainwater.value);
  const eclipse = calcularGen("eclipse", padre_eclipse.value, madre_eclipse.value);
  const mack = calcularGen("mack_snow", padre_mack.value, madre_mack.value);
  const giant = calcularGen("giant", padre_giant.value, madre_giant.value);

  bloque("Tremper", tremper, padre_tremper.value, madre_tremper.value);
  bloque("Bell", bell, padre_bell.value, madre_bell.value);
  bloque("Rainwater", rain, padre_rainwater.value, madre_rainwater.value);
  bloque("Eclipse", eclipse, padre_eclipse.value, madre_eclipse.value);
  bloque("Mack Snow", mack, padre_mack.value, madre_mack.value);
  bloque("Giant", giant, padre_giant.value, madre_giant.value);

  /* =======================
     PASO 3 – COMBOS
     ======================= */
  let combos = [];

  if (
    tremper?.resultado?.visual === 100 &&
    eclipse?.resultado?.visual === 100
  ) {
    combos.push("RAPTOR");
  }

  if (
    tremper?.resultado?.visual === 100 &&
    eclipse?.resultado?.visual === 100 &&
    mack?.resultado?.super === 100
  ) {
    combos.push("SUPER RAPTOR / DIABLO BLANCO");
  }

  if (combos.length > 0) {
    t += "COMBOS DETECTADOS\n";
    combos.forEach(c => t += "- " + c + "\n");
  }

  resultado.textContent = t || "No hay genes activos en este cruce.";
}
</script>

</body>
</html>
